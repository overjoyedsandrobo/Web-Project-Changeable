<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ project_name }}</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

    <header>
        <h1>{{ project_name }}</h1>
        <p>Rule-based generative exploration</p>
    </header>

    <main>
        <div id="canvas-container">
            <!-- Generation output will go here -->
            <canvas id="generation-canvas"></canvas>
        </div>

        <div id="controls">
            <div class="controls-top">
                <h2>Controls</h2>
                <button id="helpBtn" class="icon-btn" title="Help" aria-label="Help">?</button>
            </div>


            <div class="control-group">
                <label class="label" for="cols">Columns</label>
                <input id="cols" type="number" min="4" max="64" value="16" />
            </div>

            <div class="control-group">
                <label class="label" for="rows">Rows</label>
                <input id="rows" type="number" min="4" max="64" value="16" />
            </div>

            <div class="control-group">
                <label class="label" for="ruleMax">Rule count</label>
                <input id="ruleMax" type="number" min="2" max="12" value="6" />
                <div class="hint">Click cells to cycle rules: 0 → 1 → ...</div>
            </div>

            <div class="control-group">
                <button id="clearBtn" class="btn">Clear grid</button>
            </div>

            <div class="control-group">
                <button id="generateBtn" class="btn">Generate</button>
            </div>

            <div class="control-group">
                <label class="label">
                    <input id="randomizeSeed" type="checkbox" checked />
                    Randomize seed
                </label>
            </div>

            <div class="control-group">
                <label class="label" for="seed">Seed</label>
                    <input id="seed" type="number" min="0" max="999999999" value="12345" />
                    <div class="hint">Same grid + same seed = same output.</div>
                </div>

               <details class="control-group collapsible" id="saveLoadPanel">
                    <summary class="collapse-btn">Save / Load</summary>

                    <div class="stack">
                        <button id="saveBtn" class="btn">Save design</button>
                        <button id="loadBtn" class="btn">Load design</button>

                        <textarea id="designData" rows="6" class="textarea"></textarea>
                        <div class="hint">Copy/share this text to reproduce a design.</div>
                    </div>
                </details>

            <div class="control-group">
                <label class="label" for="steps">Steps</label>
                <input id="steps" type="number" min="1" max="1000" value="16" />
                <div class="hint">How long the structure grows.</div>
            </div>

            <div class="control-group">
                <label class="label" for="seedMode">Seeds</label>
                <select id="seedMode">
                    <option value="nonzero" selected>All non-zero cells</option>
                    <option value="center">Center cell only</option>
                    <option value="random">Random cells</option>
                </select>
            </div>

            <div class="control-group">
                <label class="label" for="seedCount">Random seed count</label>
                <input id="seedCount" type="number" min="1" max="200" value="25" />
            </div>

            <div class="control-group">
                <label class="label">
                    <input id="showGrid" type="checkbox" checked />
                    Show grid overlay
                </label>
            </div>

            <div class="control-group">
                <div class="legend" id="legend"></div>
            </div>
            <div class="controls-bottom-spacer"></div>

        </div>
    </main>
    <div id="helpModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
        <div class="modal-backdrop" id="helpBackdrop"></div>

        <div class="modal-card">
            <div class="modal-header">
                <h3 id="helpTitle">Help</h3>
                <button id="helpClose" class="icon-btn" aria-label="Close">✕</button>
            </div>

            <div class="modal-body">
                <div class="help-section">
                    <h4>Editing the Grid</h4>
                    <ul>
                    <li><b>Click a rule</b> in the legend to select it.</li>
                    <li><b>Left click / drag</b> paints the selected rule.</li>
                    <li><b>Shift + click / drag</b> erases a cell (sets it to 0).</li>
                    <li><b>Right click / drag</b> also erases.</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Generation</h4>
                    <ul>
                    <li><b>Generate</b> interprets the grid into a structure.</li>
                    <li>The grid acts as a <b>program</b>, not a drawing.</li>
                    <li>Rules steer growth direction and branching.</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Seed & Variations</h4>
                    <ul>
                    <li><b>Randomize seed on generate</b> (checked): every Generate creates a new variation.</li>
                    <li>Uncheck it to make results <b>repeatable</b> using the Seed number.</li>
                    <li>Same grid + same seed = same output.</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h4>Tips</h4>
                    <ul>
                    <li>Start simple, then refine small areas.</li>
                    <li>Use branching rules to create organic structures.</li>
                    <li>Symmetry and repetition often produce “lamp-like” forms.</li>
                    </ul>
                </div>
            </div>           
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
